\chapter{Booleove funkcije i interesantna svojstva}

Funkcija $f$ u općenitom je smislu definirana kao preslikavanje člana jednog skupa, koji se naziva domena u točno određeni član drugog skupa, koji se naziva kodomena.

Ako su domena i kodomena skup realnih brojeva $\mathds{R}$, funkcija $f : \mathds{R}^n \rightarrow \mathds{R}$ zove se \textbf{realna funkcija}.

\textbf{Booleova funkcija} je funkcija čija su domena i kodomena iz skupa $\mathds{B}$, što je skup elemenata $\mathds{B} = \{0, 1\}$.

\section{Načini prikaza}
Booleove funkcije moguće je jednoznačno definirati na brojne načine.
Najjednostavniji i često korišteni način je prikaz \textbf{tablicom istinitosti}, što je prikaz vrijednosti funkcije za sve moguće kombinacije varijabli, poredanih prema leksikografskom poretku vrijednosti ulaznih varijabli. 
\begin{table}
\centering
\begin{tabular}{ccc|c}
$x_1$ & $x_2$ & $x_3$ & $f(\vec{x})$ \\ \hline
 0 & 0 & 0 & 0 \\
 0 & 0 & 1 & 1 \\
 0 & 1 & 0 & 1 \\
 0 & 1 & 1 & 0 \\
 1 & 0 & 0 & 1 \\
 1 & 0 & 1 & 0 \\
 1 & 1 & 0 & 0 \\
 1 & 1 & 1 & 1
\end{tabular}
\caption{Primjer prikaza Booleove funkcije tablicom istinitosti}
\label{tbl:truth_table}
\end{table}
Tablica \ref{tbl:truth_table} predstavlja primjer prikaza Booleove funkcije $3$ varijable tablicom istinitosti.
Kako je redoslijed ulaznih varijabli u tablici istinitosti dogovoren, moguće je zapisivati samo zadnji stupac te istu funkciju prikazati kao \texttt{01101001}, što je zapis korišten u ostatku rada.

Osim tablice istinitosti postoje i kanonski oblici zapisivanja Booleovih funkcija, što se ostvaruje zapisivanjem varijabli i operacija koje nad njima djeluju.
Jedan od kanonskih oblika je suma minterma.
Minterm je izraz za kojega funkcija poprima vrijednost $1$ u samo jednom retku tablice istinitosti.
Unutar minterma, varijable su povezane operacijom AND, dok su mintermi međusobno povezani operacijom OR.
Zapis funkcije prikazane u tablici \ref{tbl:truth_table} kao suma minterma dan je u izrazu \eqref{eq:minterm}.
\begin{equation}\label{eq:minterm}
    f(x_1, x_2, x_3) = \bar{x}_1\bar{x}_2x_3 + \bar{x}_1x_2\bar{x}_3 + x_1\bar{x}_2\bar{x}_3 + x_1x_2x_3
\end{equation}

Izraz koji poprima vrijednost $0$ u samo jednom retku tablice istinitosti zove se maksterm.
Booleovu funkciju moguće je zapisati i kao umnožak maksterma, gdje su varijable unutar maksterma povezane operacijom OR, dok su makstermi međusobno povezani operacijom AND.
Zapis funkcije iz prethodnih primjera umnoškom maksterma prikazan je u izrazu \eqref{eq:maxterm}.
\begin{equation}\label{eq:maxterm}
    f(x_1, x_2, x_3) = \left(x_1 + x_2 + x_3\right) \cdot \left(x_1 + \bar{x}_2 + \bar{x}_3\right) \cdot \left(\bar{x}_1 + x_2 + \bar{x}_3\right) \cdot \left(\bar{x}_1 + \bar{x}_2 + x_3\right)
\end{equation}

Prikazani kanonski oblici koriste ukupno $3$ različite računske operacije; negaciju, AND i OR.
Booleovu funkciju je moguće zapisati i uz korištenje samo $2$ različite operacije, poput u zapisu u algebarskom normalnom obliku gdje se koriste samo operacije XOR i AND.
Zapis funkcije iz prethodnih primjera u algebarskom normalnom obliku prikazan je u izrazu \eqref{eq:anf}.
\begin{equation}\label{eq:anf}
    f(x_1, x_2, x_3) = x_1 \oplus x_2 \oplus x_3
\end{equation}

\begin{figure}[ht!] 
    \centering
    \includegraphics[width=.8\textwidth]{img/operator_tree}
    \captionsetup{justification=centering}
    \caption{Primjer prikaza Booleove funkcije stablom operatora}
    \label{fig:operator_tree}
\end{figure}
Svi opisani načini prikaza Booleovih funkcija posjeduju zajedničko svojstvo da svakoj funkciji odgovara točno jedan mogući prikaz.
To nije slučaj kod prikaza stablom operatora, gdje se funkcija grafički prikazuje kroz stablo, čiji s čvorovi operatori, a listovi varijable.
Svaki operator iz stabla primjenjuje se na djecu tog čvora.
Ovisno o korištenim operatorima, moguće je dobiti različite prikaze, a jedan od mogućih prikaza za prethodno korištenu funkciju dan je na slici \ref{fig:operator_tree}.
Stablo na slici izgrađeno je korištenjem operatora AND, OR, XOR i NOT.


\section{Svojstva Booleovih funkcija}

Realna funkcija $f$ je \textbf{linearna funkcija} ako je oblika:
\begin{equation}
    f(\vec{x}) = a_1x_1 + a_2x_2 + \dots + a_nx_n,
\end{equation}
gdje su $a_1, a_2, \dots, a_n \in \mathds{R}$, $x_1, x_2, \dots, x_n \in \mathds{R}$ te $f(\vec{x}) \in \mathds{R}$.

Realna funkcija je \textbf{afina funkcija} ako je oblika:
\begin{equation}
    f(\vec{x}) = a_0 + a_1x_1 + a_2x_2 + \dots + a_nx_n,
\end{equation}
gdje su $a_0, a_1, a_2, \dots, a_n \in \mathds{R}$, $x_1, x_2, \dots, x_n \in \mathds{R}$ te $f(\vec{x}) \in \mathds{R}$.

Slično kao i za realne funkcije, moguće je definirati linearnu i afinu Boolevou funkciju.
Pritom se umjesto operacija zbrajanja koristi operacija logičkog isključivo ili \engl{exclusive or}, odnosno XOR, dok se umjesto množenja koristi operacija konjunkcije, odnosno AND.

Booleova funkcija je linearna, ako je oblika:
\begin{equation}
    f(\vec{x}) = a_1x_1 \oplus a_2x_2 \oplus \dots \oplus a_nx_n,
\end{equation}
gdje su $a_1, a_2, \dots, a_n \in \mathds{B}$, $x_1, x_2, \dots, x_n \in \mathds{B}$ te $f(\vec{x}) \in \mathds{B}$.
Primjer linearne Booleove funkcije dan je u prethodno korištenoj funkciji \texttt{01101001}.
To svojstvo je teško primjetiti korištenjem prikaza tablice istinitosti, ali ga je trivijalno za primjetiti korištenjem algebarskog normalnog oblika, kao što se vidi iz izraza \eqref{eq:anf}.

Booleova funkcija je afina, ako je oblika:
\begin{equation}
    f(\vec{x}) = a_0 \oplus a_1x_1 \oplus a_2x_2 \oplus \dots \oplus a_nx_n,
\end{equation}
gdje su $a_0, a_1, a_2, \dots, a_n \in \mathds{B}$, $x_1, x_2, \dots, x_n \in \mathds{B}$ te $f(\vec{x}) \in \mathds{B}$.
Za svaku linearnu Booleovu funkciju vrijedi da je ona ujedno i afina Booleova funkcija, zbog čega je i prethodno spomenuta funkcija afina.
Obrat tvrdnje ne vrijedi, te je recimo funkcija \texttt{10010110} afina Booleova funkcija, ali nije linearna, što se vidi iz prikaza u algebarskom normalnom obliku danom u izrazu \eqref{eq:affine_function}.
\begin{equation} \label{eq:affine_function}
    f(\vec{x}) = 1 \oplus x_1 \oplus x_2 \oplus x_3,
\end{equation}

Booleova funkcija je \textbf{balansirana} ako u tablici istinitosti sadrži jednak broj vrijednosti $0$ i vrijednosti $1$.
Funkcija prikazana tablicom \ref{tbl:truth_table} je balansirana jer u svojoj tablici istinitosti sadrži $4$ nule i $4$ jedinice.
Funkcija \texttt{00100101} nije balansirana jer u tablici istinitosti ima $5$ nula, a samo $3$ jedinice. 

Za dvije Booleove funkcije, definirana je \textbf{Hammingova udaljenost} kao broj bitova po kojima se njihove tablice istinitosti međusobno razlikuju.
Tako je na primjer Hammingova udaljenost funkcija $f_1 =$ \texttt{01001011} i $f_2 =$ \texttt{00100111} iznosi $4$, jer se funkcije razlikuju u drugom, trećem, petom i šestom bitu.

\textbf{Nelinearnost} Booleove funkcije definirana je kao minimalna Hammingova udaljenost od svih afinih Booleovih funkcija.

Booleova funkcija $f$ je \textbf{Bent-funkcija} ako za dani broj varijabli posjeduje svojstvo maksimalne nelinearnosti te je jednako udaljena od svih afinih Booleovih funkcija.
Bent funkcija postoje samo za paran broj varijabli, ali postoji i skupina semi-bent-funkcija definirana za neparan broj varijabli, što je opisano u knjizi \cite{CryptographicBooleanFunctions}.

Na primjeru funkcije s dvije varijable, postoji ukupno $8$ afinih funkcija.
To su redom: \\*
\begin{minipage}[t]{.5\textwidth}
    \begin{equation*}
        \begin{aligned}
            f_1(\vec{x}) &= 0\\
            f_2(\vec{x}) &= x_1\\
            f_3(\vec{x}) &= x_2\\
            f_4(\vec{x}) &= x_1 \oplus x_2\\
        \end{aligned}
    \end{equation*}
\end{minipage}%
\begin{minipage}[t]{.5\textwidth}
    \begin{equation*}
        \begin{aligned}
            f_5(\vec{x}) &= 1\\
            f_6(\vec{x}) &= 1 \oplus x_1\\
            f_7(\vec{x}) &= 1 \oplus x_2\\
            f_8(\vec{x}) &= 1 \oplus x_1 \oplus x_2.\\
        \end{aligned}
    \end{equation*}
\end{minipage}
Radi jednostavnosti izračuna Hammingove udaljenosti, u nastavku je dan prikaz afinih Booleovih finkcija dviju varijabli korištenjem tablice istinitosti.\\*
\begin{minipage}[t]{.5\textwidth}
    \begin{equation*}
        \begin{aligned}
            f_1(\vec{x}) &= 0000\\
            f_2(\vec{x}) &= 0011\\
            f_3(\vec{x}) &= 0101\\
            f_4(\vec{x}) &= 0110\\
        \end{aligned}
    \end{equation*}
\end{minipage}%
\begin{minipage}[t]{.5\textwidth}
    \begin{equation*}
        \begin{aligned}
            f_5(\vec{x}) &= 1111\\
            f_6(\vec{x}) &= 1100\\
            f_7(\vec{x}) &= 1010\\
            f_8(\vec{x}) &= 1001\\
        \end{aligned}
    \end{equation*}
\end{minipage}
Na primjeru funkcije \texttt{1011}, moguće je izračunati da Hammingova udaljenost te funkcije od navedenih afinih funkcija iznosi redom: $3$, $1$, $3$, $3$, $1$, $3$, $1$ i $1$.
Najmanja udaljenost iznosi $1$, zbog čega i nelinearnost funkcije \texttt{1011} iznosi također $1$.
Kako je udaljenost od svake grupe afinih funkcija jednaka (pritom se istom grupom smatraju funkcije $f_1$ i $f_2$ za koje vrijedi da je $f_1 = 1 \oplus f_2$), ova funkcija je ujedno i Bent-funkcija.

\section {Walshov spektar}
Walshova transformacija Booleove funkcije $f$ definirana je kao:
\begin{equation}\label{eq:walsh transform}
    W_f(\vec{w}) = \sum_{\vec{x} \in \mathds{B}^n}f(\vec{x})(-1)^{\vec{w}\vec{x}},
\end{equation}
čime je definiran Walshov koeficijent $W_f(\vec{w})$.
Skup Walshovih koeficijenata za sve $\vec{w} \in \mathds{B}^n$, zove se \textbf{Walshov spektar} Booleove funkcije \cite{CryptographicBooleanFunctions}.

Svaki Walshov koeficijent predstavlja neočekivanu udaljenost \engl{unexpected distance} \cite{MeasuringBoolean} Booleove funkcije $f$ od pripadne linearne Booleove funkcije.
Za svaki par Booleovih funkcija, očekivana vrijednost Hammingove udaljenosti iznosi pola od ukupnog broja bitova u tablici istinitosti, odnosno $2^{n-1}$.
Neočekivana udaljenost definirana je kao razlika stvarne Hammingove udaljenosti dviju funkcija i njihove očekivane udaljenosti.

Na primjeru funkcije čija je tablica istinitosti $00111010$, Walshov koeficijent za $\vec{v} = 010$, odgovarati će neočekivanoj udaljenosti od linearne funkcije $f(\vec{x}) = x_1$, čija je tablica istinitosti jednaka $00110011$.
Kako je riječ o funkcijama $3$ varijable, očekivana udaljenost iznosi $2^{3-1} = 4$, dok je stvarna Hammingova udaljenost $2$.
Razlika te dvije vrijednosti daje $-2$, što je vrijednost neočekivane udaljenosti dane funkcije, kao i pripadni Walshov koeficijent.

Walshov spektar moguće je izračunati direktno korištenjem izraza \eqref{eq:walsh transform}, što je moguće izvesti u vremenskoj složenosti $\mathcal{O}(n^2)$.
Isto je moguće izračunati u vremenskoj složenosti $\mathcal{O}(n\log n)$ korištenjem brze Walshove transformacije \engl{fast Walsh transform}.
Taj se postupak provodi uzastopnom primjenom operatora koji za par brojeva $(a, b)$, računa novi par $(a', b')$ prema izrazu:
\begin{equation}\label{eq:fwt}
    (a', b') = (a+b, a-b).
\end{equation}
\begin{figure}[ht!] 
    \centering
    \includegraphics[width=.6\textwidth]{img/fwt_example}
    \captionsetup{justification=centering}
    \caption{Primjer izračuna brze Walshove transformacije nad Booleovom funkcijom čija je tablica istinitosti $00111010$}
    \label{fig:fwt_example}
\end{figure}
Na slici \ref{fig:fwt_example} prikazan je cjelokupni postupak izračuna brze Walshove transformacije za prethodno prikazanu funkciju.
Postupak se provodi u $\log n$ koraka, a svaki je korak prikazan jednim stupcem u slici.
Stupci na slici međusobno su povezani linijama koje prikazuju iz kojih brojeva je izračunat broj u pojedinom stupcu.
Točnije, svaki broj je povezan sa točno $2$ broja iz prethodnog stupca, što ukazuje na to da je on dobiven zbrojem ili razlikom ta dva broja, u skladu s operatorom \eqref{eq:fwt}.
Prvi stupac prikazuje Booleovu funkciju nad kojom se računa brza Walshova transformacija.
U prvom koraku algoritma, tablica istinitosti se dijeli na grupe veličine $2$, te se na svaku skupinu primjenjuje operator \eqref{eq:fwt}, čime se dobije rezultat prikazan u drugom stupcu slike.
Sljedeći korak koristi grupe veličine $4$ te se operator \eqref{eq:fwt} primjenjuje redom na sve parove međusobno udaljene za $2$.
Općenito vrijedi da se u $n$-tom koraku brojevi grupiraju u grupe veličine $2^n$, a operator \eqref{eq:fwt} se primjenjuje na one brojeve unutar grupe koji se nalaze na međusobnoj udaljenosti $2^{n-1}$.
Postupak se ponavlja sve dok u zadnjem koraku ne preostane samo jedna grupa koja uključuje sve brojeve.

Iz opisanog postupka, kao i iz slike \ref{fig:fwt_example} moguće je primjetiti važno svojstvo, točnije kako svaki bit tablice istinitosti utječe na iznos pojedinog Walshovog koeficijenta. 
Navedeno svojstvo prikazano je podebljanom linijom na slici, čime su prikazani svi bitovi koji su uključeni u izračun trećeg Walshovog koeficijenta.
Također se primjećuje kako vrijedi i obrat, odnosno da svaki pojedini bit utječe na sve vrijednosti Walshovog spektra.

Primjećuje se kako opisani postupak rezultira ispravnim Walshovim koeficijentima za cijeli Walshov spektar booleove funkcje, osim za prvi koeficijent.
Dobiven prvi koeficijent odgovara Hammingovoj težini Booleove funkcije, odnosno broju jedinica u njezinoj tablici istinitosti.
Ova činjenica predstavlja dodatno kompliciranje postupka izračuna vrijednosti željenih svojstava, s obzirom na to da je prvi broj potrebno obrađivati na drugi način od ostatka spektra.
U radu \cite{MeasuringBoolean} taj je problem riješen na način da se na vrijednosti tablice istinitosti primijeni sljedeća transformacija:
\begin{equation}
    x' = -1^x.
\end{equation}
Na taj se način skup ${0, 1}$ preslikava u skup ${1, -1}$.
Postupak izračuna brze Walshove transformacije uz korištenje navedene transformacije ulaznih bitova prikazan je na slici \ref{fig:transformed_fwt_example}.
\begin{figure}[ht!] 
    \centering
    \includegraphics[width=.6\textwidth]{img/transformed_fwt_example}
    \captionsetup{justification=centering}
    \caption{Primjer izračuna brze Walshove transformacije nad Booleovom funkcijom čija je tablica istinitosti $00111010$ uz primjenu transformacije bitova}
    \label{fig:transformed_fwt_example}
\end{figure}
Novo dobiveni rezultati razlikuju se od prethodnih po predznaku i magnitudi.
Usprkos tome, rezultati u prikladniji zbog prvog koeficijenta koji po svojstvima odgovara ostalima.

Pomoću Walshovog spektra računaju se ostala svojstva Booleove funkcije.
Funkcija je balansirana ako je njezin prvi Walshov koeficijent jednak nuli \cite{MaximalNonlinearity}:
\begin{equation}
    W_f(\vec{0}) = 0.
\end{equation} 

Nelinearnost $N_f$ Booleove funkcije $f$ određena je apsolutno najvećim Walshovim koeficijentom prema izrazu \cite{MaximalNonlinearity}:
\begin{equation}
    N_f = 2^{n-1} - \frac{1}{2}\max_{\vec{w} \in \mathds{B}^n} \abs{W_f(\vec{w})}.
\end{equation}
Na primjeru funkcije prikazane u slici \ref{fig:transformed_fwt_example}, apsolutno najveći koeficijent iznosi $4$, odnosno $-4$ iz čega slijedi da je nelinearnost funkcije jednaka $N_f = 2^{3-1} - \frac{1}{2}4$, odnosno $N_f = 2$.

Za svaku Booleovu funkciju $f$ sa $n$ varijabli vrijedi Parsevalova jednakost koja glasi:
\begin{equation}
    \sum_{\vec{w}\in \mathds{B}^n} \left( W_f(\vec{w}) \right)^2 = 2^{2n}.
\end{equation} 
Iz toga slijedi da nelinearnost $N_f$ Bent-funkcije sa $n$ varijabli iznosi:
\begin{equation}
    N_f = 2^{n-1} - 2^{\frac{n}{2}-1}.
\end{equation}